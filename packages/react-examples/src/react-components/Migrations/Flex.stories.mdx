import { Meta } from '@storybook/addon-docs/blocks';
import { CodeComparison, CodeExample } from './utils';

<Meta title="Migrations/Flex" />

# Flex

## Deprecation

There were several discussions about Flex and the concerns of performance/bundle size vs the benefits we get from a component like it. The conclusion we came to is:

- Any implementation we come up with will always be an extra layer with regards to performance and bundle size, compared to just using makeStyles directly.
- There's little benefit to usability given that the user needs to learn how to use the component API regardless. If they already have CSS knowledge, then no learning is required.
- Users are limited to the functionality/property support we end up implementing, forcing them to override in edge cases.

As such, it was decided to drop this component going forward. To ease migrating, below are resources to help you migrate to other solutions.

## Migration Guide

You will find below a migration guide for both Fabric's Stack component and Northstar's Flex component. For each property provided, there's a counterpart `make-styles` implementation along with a plain CSS implementation for comparison.

Please keep in mind that the property migration assume the `Default State` styles are already being applied as each component property overrides or adds 1 or more CSS properties.

<!-- Required? -->
Also consider this guide does not take into consideration possible overriding of styles in your component hierarchy. To try and mitigate this, styles that are applied by default by the browser (i.e. `flex-wrap: nowrap`) will still be written below. If you have no other styles influencing your component, there is no need to apply those specific styles. Please consult [MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/CSS/) for more information over what are the initial CSS values being applied.
<!---->

### @fluentui/react - Stack

#### Default state

Stack's approach to layout is slightly different from Flex's and a column layout is the default arrangement. For a clean usage scenario of Stack, this is the required CSS to achieve the same result:

<CodeComparison>
  <CodeExample>

    ```js
    makeStyles({
      root: {
        display: 'flex',
        flexDirection: 'column',
        flexWrap: 'nowrap',
        width: 'auto',
        height: 'auto',
        boxSizing: 'border-box',
        '> *': {
          textOverflow: 'ellipsis',
        },
        '> :not(:first-child)': {
          marginTop: '0px',
        },
        '> *:not(.ms-StackItem)': {
          flexShrink: 1,
        },
      },
    })
    ```

  </CodeExample>
  <CodeExample>

    ```css
    :root {
      display: flex;
      flex-direction: column;
      flex-wrap: nowrap;
      width: auto;
      height: auto;
      box-sizing: border-box;
    }
    :root > * {
      text-overflow: ellipsis;
    }
    :root > :not(:first-child) {
      margin-top: 0px;
    }
    :root > *:not(.ms-StackItem) {
      flex-shrink: 1;
    }
    ```

  </CodeExample>
</CodeComparison>

#### as

The `as` prop strictly replaces which component will be rendered. The default value for this is `div`.

### disableShrink

<CodeComparison>
  <CodeExample>

    ```js
    makeStyles({
      root: {
        '> *': {
          flexShrink: 0,
        }
      },
    })
    ```

  </CodeExample>
  <CodeExample>

    ```css
    :root > * {
      flex-shrink: 0,
    }
    ```

  </CodeExample>
</CodeComparison>

### gap

A quick an easy way of applying gap to all children like this prop did is as follows:

<CodeComparison>
  <CodeExample>

    ```js
    makeStyles({
      root: {
        '> *': {
          margin: "10px",
        }
      },
    })
    ```

  </CodeExample>
  <CodeExample>

    ```css
    :root > * {
      margin: 10px,
    }
    ```

  </CodeExample>
</CodeComparison>

If you want to replicate the exact behavior of the prop, you'll have to keep in mind the following:
- For horizontal layouts, you need to apply the margin to either left or right.
- For vertical layouts, you need to apply the margin to either top or bottom.

To keep the margin only between the items, you can prevent it from being applied to the last (or first) element.
Heres an example with an horizontal layout and margin-right:

<CodeComparison>
  <CodeExample>

    ```js
    makeStyles({
      root: {
        display: 'flex',
        flexDirection: 'row',
        '> :not(:last-child)': {
          marginRight: '10px',
        }
      },
    })
    ```

  </CodeExample>
  <CodeExample>

    ```css
    :root {
      display: flex;
      flex-direction: row;
    }
    :root > :not(:last-child) {
      margin-right: 10px,
    }
    ```

  </CodeExample>
</CodeComparison>

### grow

<CodeComparison>
  <CodeExample>

    ```js
    makeStyles({
      root: {
        '> *': {
          flexGrow: '1',
        }
      },
    })
    ```

  </CodeExample>
  <CodeExample>

    ```css
    :root > * {
      flex-grow: 1
    }
    ```

  </CodeExample>
</CodeComparison>

### @fluentui/react-northstar - Flex

#### Default state

For Northstar's Flex, the following layout is what's required to have a no prop implementation:

<CodeComparison>
  <CodeExample>

    ```js
    makeStyles({
      root: {
        display: 'flex',
      },
    })
    ```

  </CodeExample>
  <CodeExample>

    ```css
    :root {
      display: flex;
    }
    ```

  </CodeExample>
</CodeComparison>

#### as

The `as` prop strictly replaces which component will be rendered. The default value for this is `div`.

## Other resources
